import { beforeAll, describe, expect, it } from "vitest";
import {
  FeedbackStatusCode,
  initReefState,
  selectedTokenBalances$,
  selectedTokenBalances_status$,
  skipBeforeStatus$,
} from "../../src/reefState";
import { AVAILABLE_NETWORKS } from "../../src/network";
import { firstValueFrom, skip } from "rxjs";

describe("graphql tests", () => {
  const accountId = "5EnY9eFwEDcEJ62dJWrTXhTucJ4pzGym4WZ2xcDKiT3eJecP";
  beforeAll(async () => {
    initReefState({
      network: AVAILABLE_NETWORKS.testnet,
      jsonAccounts: {
        accounts: [
          {
            address: accountId,
            isSelected: true,
            meta: { source: "reef" },
          },
        ],
        injectedSigner: {},
      },
    });
  });

  it("should log list of tokens", async () => {
    const tokens$ = skipBeforeStatus$(
      selectedTokenBalances_status$,
      FeedbackStatusCode.COMPLETE_DATA
    );
    const response = (await firstValueFrom(tokens$)).data;
    response.map(token => {
      if (token.data.address == "0x6685129d58bbf9FCd567770eFf1b9875e1fA24Bc") {
        expect(token.data.iconUrl).equal(
          "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMzAwIiBoZWlnaHQ9IjMwMCIgcng9IjE1MCIgZmlsbD0iIzQwRkZGRiIvPjxtYXNrIGlkPSJhIiBzdHlsZT0ibWFzay10eXBlOmFscGhhIiBtYXNrVW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4PSI1NyIgeT0iMTIxIiB3aWR0aD0iMTM2IiBoZWlnaHQ9IjU0Ij48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTU3LjM4IDEyMS4zNjFoMTM1LjI1M3Y1Mi44MzdINTcuMzh2LTUyLjgzN1oiIGZpbGw9IiNmZmYiLz48L21hc2s+PGcgbWFzaz0idXJsKCNhKSI+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik02NC45MyAxNzQuMTk4YzIuMjU2LTkuOTAxIDguMjYtMjUuMzE3IDI0LjE1LTMyLjI5OSAxNS44ODktNi45ODIgNzUuMTQxLTYuODkgOTMuMzM5LTUuOTc3IDYuMjI2LTcuNTAyIDEwLjIxNC0xMi45MTQgMTAuMjE0LTEyLjkxNHMtODUuMzcxLTUuOTUtMTA5Ljc2IDQuNzY3Yy0yNC4zOSAxMC43MTctMjUuNDkzIDQxLjMxNC0yNS40OTMgNDEuMzE0czIuODMzIDIuNDE1IDcuNTUgNS4xMDlaIiBmaWxsPSIjRkY0MDgxIi8+PC9nPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNODQuMzU1IDE0Mi40MzhjLTYuMDUgMi42NTktMTAuNzgyIDYuNDM5LTE0LjQ5MSAxMC42OTEtMy4wOTEgOC42OTEtMy4zNjEgMTUuOTYxLTMuMzYxIDE1Ljk2MXMyLjgzMyAyLjQxNSA3LjU1IDUuMTA3YzIuMjU2LTkuOSA4LjI2LTI1LjMxNiAyNC4xNS0zMi4yOTkgMTAuODI1LTQuNzU3IDU4LjA1OS02LjIyOCA3My40NTUtNi4zOTUtMTkuMDI1LS4zNjYtNzMuMTA0LjY5Ni04Ny4zMDMgNi45MzVaIiBmaWxsPSIjMUUwMTM1Ii8+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0yMDMuODI0IDEyNC4xMDRzLTIuODU3LS4zMDktNy41NDktLjY1OWMtMS4xODcgMS41ODYtNS4wMjkgNi42NTItMTAuNTA1IDEzLjI2NiAyLjc2Ni4wNzggNS40MDIuMTg0IDcuODQyLjMwNyA2LjIyNC03LjUwMiAxMC4yMTItMTIuOTE0IDEwLjIxMi0xMi45MTRaTTIxNC41NTUgMTI1LjQ5N3MtMi44NTctLjMwOS03LjU0OS0uNjU5Yy0xLjE4NyAxLjU4Ni01LjAyOSA2LjY1My0xMC41MDUgMTMuMjY3IDIuNzY2LjA3NyA1LjQwMi4xODMgNy44NDIuMzA2IDYuMjI0LTcuNTAyIDEwLjIxMi0xMi45MTQgMTAuMjEyLTEyLjkxNFoiIGZpbGw9IiNGRjQwODEiLz48bWFzayBpZD0iYiIgc3R5bGU9Im1hc2stdHlwZTphbHBoYSIgbWFza1VuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeD0iMjYiIHk9IjEzNSIgd2lkdGg9IjI0NyIgaGVpZ2h0PSI0NSI+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0yNiAxMzUuMzI4aDI0N3Y0My44OTFIMjZ2LTQzLjg5MVoiIGZpbGw9IiNmZmYiLz48L21hc2s+PGcgbWFzaz0idXJsKCNiKSI+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0yNjUuNjA5IDEzNS4zMjlhMzIuOTQyIDMyLjk0MiAwIDAgMC0yMS41ODkgOC4wNTlsLTguMTA3IDcuMDMzLTguMTA3LTcuMDMzYTMyLjkzNyAzMi45MzcgMCAwIDAtMjEuNTg3LTguMDU5aC03LjM5OXYtLjAwMUg2My41OTRhMzIuOTQgMzIuOTQgMCAwIDAtMjEuNTg4IDguMDZMMjYgMTU3LjI3NGwxNi4wMDYgMTMuODg2YTMyLjk0IDMyLjk0IDAgMCAwIDIxLjU4NyA4LjA1OUgyMDYuMjJhMzIuOTM3IDMyLjkzNyAwIDAgMCAyMS41ODctOC4wNTlsOC4xMDctNy4wMzMgOC4xMDcgNy4wMzNhMzIuOTQyIDMyLjk0MiAwIDAgMCAyMS41ODkgOC4wNTlIMjczdi00My44OWgtNy4zOTFaIiBmaWxsPSIjMDA2MDY0Ii8+PC9nPjxtYXNrIGlkPSJjIiBzdHlsZT0ibWFzay10eXBlOmFscGhhIiBtYXNrVW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4PSIyNiIgeT0iMTM1IiB3aWR0aD0iMjQ3IiBoZWlnaHQ9IjQ1Ij48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTYzLjU5MyAxMzUuMzI4YTMyLjk0OCAzMi45NDggMCAwIDAtMjEuNTg3IDguMDZMMjYgMTU3LjI3NGwxNi4wMDYgMTMuODg3YTMyLjk1MiAzMi45NTIgMCAwIDAgMjEuNTg3IDguMDU5SDIwNi4yMmEzMi45NDggMzIuOTQ4IDAgMCAwIDIxLjU4Ny04LjA1OWw4LjEwOC03LjAzMyA4LjEwNiA3LjAzM2EzMi45NTUgMzIuOTU1IDAgMCAwIDIxLjU4OSA4LjA1OUgyNzN2LTQzLjg5MWgtNy4zOTFhMzIuOTUgMzIuOTUgMCAwIDAtMjEuNTg5IDguMDU5bC04LjEwNiA3LjAzMy04LjEwOC03LjAzM2EzMi45NCAzMi45NCAwIDAgMC0yMS41ODctOC4wNTloLTcuMzk5di0uMDAxSDYzLjU5NFoiIGZpbGw9IiNmZmYiLz48L21hc2s+PGcgbWFzaz0idXJsKCNjKSI+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0yNjUuNjA5IDEzNS4zMjlhMzIuOTQ4IDMyLjk0OCAwIDAgMC0yMS41ODkgOC4wNTlsLTguMTA3IDcuMDMzLTguMTA3LTcuMDMzYTMyLjk0MiAzMi45NDIgMCAwIDAtMjEuNTg3LTguMDU5aC03LjM5OXYtLjAwMUg2My41OTRhMzIuOTQ2IDMyLjk0NiAwIDAgMC0yMS41ODggOC4wNkwyNiAxNTcuMjc1bDE2LjAwNiAxMy44ODZhMzIuOTQ1IDMyLjk0NSAwIDAgMCAyMS41ODcgOC4wNTlIMjA2LjIyYTMyLjk0MiAzMi45NDIgMCAwIDAgMjEuNTg3LTguMDU5bDguMTA3LTcuMDMzIDguMTA3IDcuMDMzYTMyLjk0OCAzMi45NDggMCAwIDAgMjEuNTg5IDguMDU5SDI3M1YxMzUuMzI5aC03LjM5MVoiIGZpbGw9IiMwMDYwNjQiLz48L2c+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik05Mi41MzggMTUzLjA1MiA3Ny4zIDE2MS40NzVhLjk0MS45NDEgMCAwIDAtLjM2NyAxLjI3NWMzLjM5NyA2LjE0NCAxMS4yMDMgOC4zOTMgMTcuMzQ4IDQuOTk2bDQuODg2LTIuNzAxYS45NC45NCAwIDAgMCAuMzY3LTEuMjc1bC01LjcyMi0xMC4zNWEuOTQuOTQgMCAwIDAtMS4yNzQtLjM2OFpNNjcuMDI4IDE1MS43MmE4LjkxMSA4LjkxMSAwIDAgMS04Ljk1MyA4LjkxOWMtNC45NDQtLjAyLTguOTUzLTQuMDQzLTguOTUzLTguOTg3YTguOTEyIDguOTEyIDAgMCAxIDguOTUzLTguOTE5YzQuOTQ1LjAxOSA4Ljk1MyA0LjA0MiA4Ljk1MyA4Ljk4N1oiIGZpbGw9IiNDNkZGMDAiLz48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTYwLjk4MyAxNTEuNjk2YTIuODk0IDIuODk0IDAgMCAxLTIuOTA3IDIuODk3IDIuOTIxIDIuOTIxIDAgMCAxLTIuOTA5LTIuOTE4IDIuODk1IDIuODk1IDAgMCAxIDIuOTA5LTIuODk3IDIuOTIgMi45MiAwIDAgMSAyLjkwNyAyLjkxOFpNMTIwLjMzMiAxNTYuMDgxYTQuNDA2IDQuNDA2IDAgMCAxIDAtOC44MTFNMTIwLjMzMiAxNjYuNDMxYTQuNDA2IDQuNDA2IDAgMSAxIDAtOC44MU0xNDkuMjU0IDE1Ni4wODFhNC40MDYgNC40MDYgMCAwIDEgMC04LjgxMU0xNDkuMjU0IDE2Ni40MzFhNC40MDUgNC40MDUgMCAxIDEgMC04LjgxTTE1OC44OTUgMTYwLjY2NWE0LjQwNSA0LjQwNSAwIDEgMSAwLTguODExTTEyOS45NzMgMTYwLjg2M2E0LjQwNSA0LjQwNSAwIDEgMSAwLTguODFNMTI5Ljk3MyAxNTAuMTE1YTQuNDA2IDQuNDA2IDAgMSAxIDAtOC44MU0xMjkuOTczIDE3MS4yMTRhNC40MDYgNC40MDYgMCAxIDEgMC04LjgxMU0xMzkuNjEyIDE2MC44NjNhNC40MDUgNC40MDUgMCAxIDEgMC04LjgxTTEzOS42MTIgMTUwLjExNWE0LjQwNiA0LjQwNiAwIDAgMSAwLTguODFNMTM5LjYxMiAxNzEuMjE0YTQuNDA1IDQuNDA1IDAgMCAxIDAtOC44MTFNMTcxLjY3OCAxNTYuMDgxYTQuNDA2IDQuNDA2IDAgMCAxIDAtOC44MTFNMTcxLjY3OCAxNjYuNDMxYTQuNDA1IDQuNDA1IDAgMCAxIDAtOC44MU0yMDAuNjAxIDE1Ni4wODFhNC40MDYgNC40MDYgMCAwIDEgMC04LjgxMU0yMDAuNjAxIDE2Ni40MzFhNC40MDYgNC40MDYgMCAxIDEgMC04LjgxTTIxMC4yNCAxNjAuNjY1YTQuNDA2IDQuNDA2IDAgMCAxIDAtOC44MTFNMTgxLjMxOCAxNjAuODYzYTQuNDA0IDQuNDA0IDAgMCAxLTQuNDA1LTQuNDA1IDQuNDA0IDQuNDA0IDAgMCAxIDQuNDA1LTQuNDA1TTE4MS4zMTggMTUwLjExNWE0LjQwNSA0LjQwNSAwIDEgMSAwLTguODFNMTgxLjMxOCAxNzEuMjE0YTQuNDA1IDQuNDA1IDAgMSAxIDAtOC44MTFNMTkwLjk1OSAxNjAuODYzYTQuNDA0IDQuNDA0IDAgMCAxLTQuNDA1LTQuNDA1IDQuNDA0IDQuNDA0IDAgMCAxIDQuNDA1LTQuNDA1TTE5MC45NTkgMTUwLjExNWE0LjQwNSA0LjQwNSAwIDEgMSAwLTguODFNMTkwLjk1OSAxNzEuMjE0YTQuNDA1IDQuNDA1IDAgMSAxIDAtOC44MTFNMjUzLjcxOCAxNTYuMDgxYTQuNDA2IDQuNDA2IDAgMCAxIDAtOC44MTFNMjUzLjcxOCAxNjYuNDMxYTQuNDA2IDQuNDA2IDAgMSAxIDAtOC44MU0yNjMuMzU5IDE2MC44NjNhNC40MDQgNC40MDQgMCAwIDEtNC40MDUtNC40MDUgNC40MDQgNC40MDQgMCAwIDEgNC40MDUtNC40MDVNMjYzLjM1OSAxNTAuMTE1YTQuNDA1IDQuNDA1IDAgMSAxIDAtOC44MU0yNjMuMzU5IDE3MS4yMTRhNC40MDUgNC40MDUgMCAxIDEgMC04LjgxMU0yNzMgMTYwLjg2M2E0LjQwNSA0LjQwNSAwIDEgMSAwLTguODFNMjczIDE1MC4xMTVhNC40MDYgNC40MDYgMCAxIDEgMC04LjgxTTI3MyAxNzEuMjE0YTQuNDA2IDQuNDA2IDAgMSAxIDAtOC44MTEiIGZpbGw9IiMxRTAxMzUiLz48L3N2Zz4="
        );
      }
    });
  });
});
